'Cache bits in windows'| instances n cls inst .Window instvars has: 'bits'  [].instances _ Dictionary new: 20.for n from: user classNames do	[cls _ Smalltalkn.	cls  Window or (cls Isa: Window)		 [instances insert: n with: cls allInstances]].Class new title: Window	subclassof: Object	fields: 'frame collapsed titlepara growing exitflag style bits'	declare: '';	classified: 'Windows'.for n from: instances do [	for inst from: instancesn do [		user cr; show: 'Fixing ' + inst asString.		inst become: (Smalltalkn copy: inst)]].BitBlt understands: 'clipBy: r 	[clipwidth _ clipwidth min: r maxX - clipx.	clipheight _ clipheight min: r maxY - clipy.	clipx _ clipx max: r minX.	clipy _ clipy max: r minY]' classified: 'As yet unclassified'PanedWindow understands: 'enter | p  	[super show.	for p from: panes do		[p windowenter].	self grabBits]' classified: 'As yet unclassified'PanedWindow understands: 'show | p	[super show.	bits  nil  []	for p from: panes do		[p outline]]' classified: 'As yet unclassified'Textframe understands: 'displayall | y save	["Kludge: globally clip to window. Should fix the drawing instead"	save _ DisplayBLTer window.	DisplayBLTer clipBy: window.	y _ self displaylines: 1 to: lastline.	self clearfrom: y.	DisplayBLTer window: save]' classified: 'As yet unclassified'UserView understands: 'restore	[self restore: screenrect]' classified: 'As yet unclassified'UserView understands: 'restore: rect 	[self restore: rect without: nil]' classified: 'As yet unclassified'UserView understands: 'restore: rect without: exclude| i w hideDisp	[kbMap _ NTkbMap.	noupdate _ true.	DisplayBLTer window: rect.	rect clear.	hideDisp _ self  self rootUserview or (disp frame intersects: rect)  false.	for i from: sched length to: 1 by: 1 do		[(w _ schedi)  exclude  []		hideDisp and w  disp  []		w show].	DisplayBLTer window: screenrect.	noupdate _ false]' classified: 'As yet unclassified'UserView understands: 'restoredisplay | ext rect	[ext _ self primScreenExtent.	screenrect = (00 rect: ext) and DisplayForm extent = ext  [self mapDisplay]	self currentDisplay: (Form new extent: ext bits: (String new: ext x * ext y / 8) offset: nil)]' classified: 'As yet unclassified'UserView understands: 'save 	[self currentDisplay: (Form new extent: 11 bits: ''--'' offset: nil).	self primSave.	self restoredisplay.	self restore]' classified: 'As yet unclassified'Window understands: 'bluebug	[windowmenu bug		=1[exitflag _ false];		=2[self newframe; enter];		=3[self close. user unschedule: self. self restore. self leave. false];		=4[self style: noTitle _ (self style: noTitle)  false. user restore];		=5[self styleEdit];		=6[self forgetBits; leave; enter];		=7[self hardcopy];		=8[self print];		=9[self inspect]]' classified: 'As yet unclassified'Window understands: 'classInit 	[border _ 2  2.	titleframe _ Textframe new para: nil frame: nil.	titleloc _ 3  (4 - titleframe lineheight).	titlerun _ String new: 2.	titlerun word: 1 _ 255.	(defaultStyle _ Dictionary new: 10)		insert: fill with: white;		insert: borderWidth with: 2;		insert: borderColor with: black.	windowmenu _ Menu new string: ''underframeclosetoggle titleborder & fillrestoreprintprintbitsinspect'']' classified: 'As yet unclassified'Window understands: 'forgetBits	[bits _ nil]' classified: 'As yet unclassified'Window understands: 'frame: r 	[frame _ self fixframe: r]' classified: 'As yet unclassified'Window understands: 'grabBits	[bits _ frame bitsIntoString]' classified: 'As yet unclassified'Window understands: 'leave	[self grabBits.	style  nil  [frame border: 1 color: gray mode: xoring]]' classified: 'As yet unclassified'Window understands: 'newframe | pos rect 	[user waitnobug.	[frame  nil  []	self aboutToFrame].	pos _ OriginCursor showwhile [user waitbug].	growing _ true.	frame _ self fixframe: (pos rect: pos + 32).	frame boxcomp.	CornerCursor showwhile 		[while [pos _ user mpnext. pos] do			[[rect  nil  [user cursorloc_ pos max: frame corner]].			rect _ frame copy.			frame boxcomp.			frame _ self fixframe: (frame growto: pos).			frame boxcomp]].	frame boxcomp; outline.	self frame: frame.	growing _ false.	self forgetBits.	self takeCursor]' classified: 'As yet unclassified'Window understands: 'reposition | rect	[rect _ self repositionHotspot.	"wait for user to click or use keyboard"	until user anybug do [		user kbck  [ "pressed key, reframe by keyboard"			self grabBits.			frame boxcomp.			until user anybug do [				user kbdnext					= 193  [self repositionBy: 10. frame boxcomp];					= 194  [self repositionBy: 10. frame boxcomp];					= 195  [self repositionBy: 01. frame boxcomp];					= 196  [self repositionBy: 01. frame boxcomp];					 false  [frame boxcomp]].			frame boxcomp.			user waitnobug].		(rect has: user mp)  false 			[false]].	"clicked, reframe by mouse"	rect _ frame copy.	frame boxcomp.	until user nobug do [		frame origin  user mp  [			frame boxcomp.			frame moveto: user mp.			frame boxcomp]].	frame boxcomp.	self frame: frame.	user restore]' classified: 'As yet unclassified'Window understands: 'repositionBy: pt | outer r	[self frame: (frame moveby: pt).	user restore.	"<optimized version below not quite working yet>	outer _ frame.	[self style: noBorder  []	outer _ outer inset: 11 * (self style: borderWidth)].	for r from: (outer minus: outer + pt) do [		user restore: r without: self].	self frame: (frame moveby: pt).	self show"]' classified: 'As yet unclassified'Window understands: 'resize | rect	[rect _ self resizeHotspot.	until user anybug do [		(rect has: user mp)  false 			[false]].	self aboutToFrame.	rect _ frame copy.	frame boxcomp.	until user nobug do [		frame corner  user mp  [			frame boxcomp.			frame growto: user mp.			frame boxcomp]].	frame boxcomp.	self frame: frame.	self forgetBits.	user restore]' classified: 'As yet unclassified'Window understands: 'restore | rect	[rect _ frame.	[self style: noBorder  []	rect _ rect inset: 11 * (self style: borderWidth)].	[self style: noTitle  []	rect _ rect include: (titleframe window inset: 22)].	user restore: rect without: self]' classified: 'As yet unclassified'Window understands: 'show 	[self outline.	[bits  nil  [frame bitsFromString: bits]].	growing  []	self showtitle]' classified: 'As yet unclassified'Window classInit